<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

	<!-- Define display/content information -->
		<xsl:output method="html"/>
		<xsl:output indent="no"/>
		<xsl:output encoding="UTF-8"/>
		<xsl:output doctype-system="http://www.w3.org/TR/html4/strict.dtd" doctype-public="-//W3C//DTD HTML 4.01//EN"/>
		<xsl:output media-type="text/html"/>
		<xsl:output omit-xml-declaration="yes"/>

	<xsl:template match="/">
			
		<xsl:variable name="base" select="concat(/content/base_url,'cb/',/content/callback_code)"/>
			
		<html lang="en-GB" manifest="{$base}/manifest">
			<head>

				<!-- About this document -->

					<meta name="author"      content="Mike Cardwell. &#60;https://grepular.com/&#62;"/>
					<meta name="copyright"	 content="Copyright Â©2012 Mike Cardwell. All rights reserved."/>
					<meta name="description" content="Email Privacy Tester"/>
	
				<!-- Page title -->

					<title>Email Privacy Tester</title>

				<!-- RSS Test -->

					<link rel="alternate" type="application/rss+xml" href="{$base}/rss"/>
			
				<!-- Atom Test -->

					<link rel="alternate" type="application/atom+xml" href="{$base}/atom"/>

				<!-- JavaScript Test -->

					<script type="text/javascript" src="{$base}/js"></script>
		  
				<!-- CSS Test -->

					<link rel="stylesheet" type="text/css" href="{$base}/css"/>
		   
				<!-- CSS Attachment Test -->

					<link rel="stylesheet" type="text/css" href="cid:{/content/callback_code}.css@{/content/base_domain}"/>
 
				<!-- OpenSearch Test -->

					<link rel="search" type="application/opensearchdescription+xml" href="{$base}/opensearch"/>
	
				<!-- Meta Refresh Test -->

					<meta http-equiv="Refresh" content="1; URL={$base}/meta_refresh"/>

			</head>
			<body background="{$base}/background">

				<!-- Information -->
					
					<p style="border-bottom:1px solid #000; padding-bottom: 1em;">
						<span style="font-size:1.4em; border-bottom: 1px solid #333;">Email Privacy Tester</span><br/>
						<br/>
						You are receiving this email because somebody at IP address <xsl:value-of select="/content/ip"/>
						entered the email address <a href="mailto:{/content/to}"><xsl:value-of select="/content/to"/></a>
						into the form at <a href="{/content/base_url}"><xsl:value-of select="/content/base_url"/></a><br/>
						<br/>
						If this was not you, and you wish to not receive emails from this system in future, please visit my
						<a href="{/content/base_url}optout?email={/content/to}">opt out page</a>. Please don't mark this
						email as spam as it may cause difficulties for people using the Email Privacy Tester in future.<br/>
						<br/>
						If you <strong>were</strong> the person to submit the form, and you want to look at the results page,
						please click <a href="{/content/base_url}{/content/lookup_code}">here</a>.<br/>
						<br/>
						Please ignore anything after this line as it will probably just look like gibberish.
					</p>
				
				<!-- CSS Test - background-image:url -->
	
					<p style="background-image:url('{$base}/background_image');"></p>
				
				<!-- CSS Test - content:url -->
				
					<p style="content:url('{$base}/css_content');"></p>
			  
				<!-- CSS Test - behavior:url -->
				
					<p style="behavior:url('{$base}/css_behavior') url('{$base}/css_behavior')"></p>
 
				<!-- CSS Test - font-face {src:url} -->
					
					<style type="text/css">@font-face {src:url('<xsl:value-of select="$base"/>/font_face');}</style>
	   
				<!-- CSS Test - @import 'url' -->
				
					<style type="text/css">@import '<xsl:value-of select="$base"/>/css_import';</style>
 
				<!-- SVG background-image test -->
				
					<object data="cid:{/content/callback_code}.svg@{/content/base_domain}" type="image/svg+xml">
						<embed src="cid:{/content/code}.svg@{/content/base_domain}" type="image/svg+xml" pluginspage="http://www.adobe.com/svg/viewer/install/" />
					</object>
					<iframe src="cid:{/content/callback_code}.svg@{/content/base_domain}" width="1" height="1"></iframe>

				<!-- SVG Inline Image -->

					<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
						<image xlink:href="{$base}/svg_inline_image"/>
					</svg>

				<!-- IMG Test -->

					<img width="16" height="16" src="{$base}/img"/>

                <!-- IMG srcset attribute -->

                    <img src="#" srcset="{$base}/img_srcset 1x" width="16" height="16"/>

				<!-- Image Submit -->

					<input type="image" src="{$base}/image_submit"/>

				<!-- Anchor DNS Prefetch Test -->
	
					<a href="http://{/content/callback_code}.anchor-test.ept.{/content/base_domain}/"></a>
			  
				<!-- Link DNS Prefetch Test -->
	
					<link rel="dns-prefetch" href="http://{/content/callback_code}.link-test.ept.{/content/base_domain}/"/>
	   
				<!-- Link Prefetch Test -->
	
					<link rel="prefetch" href="{$base}/link_prefetch"/>
 
				<!-- Video Tag Tests -->
	
					<video autoplay="true" src="{$base}/video" width="1" height="1"></video>
					<video poster="{$base}/video_poster" autoplay="true" width="1" height="1">
						<source src="{$base}/video_mp4"  type='video/mp4; codecs="avc1.4D401E, mp4a.40.2"'/>
						<source src="{$base}/video_webm" type='video/webm; codecs="vp8.0, vorbis"'/>
						<source src="{$base}/video_ogg"  type='video/ogg; codecs="theora, vorbis"'/>
					</video>

				<!-- Audio Tag Test -->

					<audio src="{$base}/audio" preload="metadata" autoplay="autoplay" width="1" height="1"></audio>
			   
				<!-- Applet Tag Test -->

					<applet codebase="{$base}/applet" code="applet.class" width="1" height="1"></applet>
			   
				<!-- Object Tag Test -->
			
					<object width="16" height="16" data="{$base}/object_data" type="image/png"></object>
		
				<!-- Iframe Tag Test -->
			
					<iframe src="{$base}/iframe" width="1" height="1"></iframe>
			   
				<!-- BGSound Tag Test -->
		
					<bgsound src="{$base}/bgsound" loop="1" width="1" height="1"/>
			
			
				<!-- TESTINGMODE: CSS Expression Test -->
			
					<p style="background-color:expression((document.createElement('img'))['src']='{$base}/css_expression')"></p>

		
				<!-- Flash Test -->
	
					<object width="1" height="1">
				   		<param name="movie" value="flash.swf"/>
						<embed src="{$base}/flash" width="1" height="1"></embed>
					</object>

				<!-- View-Source Test -->
			
					<iframe width="1" height="1" src="view-source:{$base}/view_source"></iframe>

				<!-- IFrame Meta Refresh Test -->

					<iframe width="1" height="1" src="data:text/html;charset=utf-8,&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Refresh&quot; content=&quot;1; URL={$base}/iframe_refresh&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;"></iframe>
			
				<!-- IFrame Image Test -->
	
					<iframe width="1" height="1" border="none" src="data:text/html;charset=utf-8,&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;img src=&quot;{$base}/iframe_img&quot;&gt;&lt;/body&gt;&lt;/html&gt;"></iframe>
		
				<!-- Script in Script Test -->

					<xsl:value-of disable-output-escaping="yes" select="concat('&lt;sc&lt;script&gt;&lt;/script&gt;ript type=&quot;text/javascript&quot; src=&quot;',$base,'/script_in_script&quot;&gt;&lt;/sc&lt;script&gt;&lt;/script&gt;ript&gt;')"/>
	
			</body>
		</html>
		
	</xsl:template>
</xsl:stylesheet>
